<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <link rel="canonical" href="https://pakistanaddress.github.io/html/category/article-2274.htm" />
<title>Docker 安装 Confluence - Pakistan Address</title>
<!-- for-mobile-apps -->
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="icon" href="/assets/addons/xcblog/img/pakistanaddress/favicon.ico" type="image/x-icon"/>
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false);
		function hideURLbar(){ window.scrollTo(0,1); } </script>
<!-- //for-mobile-apps -->
<link href="/assets/addons/xcblog/css/pakistanaddress/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
<link href="/assets/addons/xcblog/css/pakistanaddress/style.css" rel="stylesheet" type="text/css" media="all" />
<!-- js -->
<script type="text/javascript" src="/assets/addons/xcblog/js/frontend/pakistanaddress/jquery-2.1.4.min.js"></script>
<!-- //js -->
<link href='https://fonts.googleapis.com/css?family=Maven+Pro:400,500,700,900' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,700italic,800,800italic' rel='stylesheet' type='text/css'>
<!-- start-smoth-scrolling -->
<script type="text/javascript">
	jQuery(document).ready(function($) {
		$(".scroll").click(function(event){		
			event.preventDefault();
			$('html,body').animate({scrollTop:$(this.hash).offset().top},1000);
		});
	});
</script>
<!-- start-smoth-scrolling -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?21f4e50ed805b3a1bd1374e6b345c04a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3332997411212854"
     crossorigin="anonymous"></script>
</head>

<body>
    <!-- header -->
	<div class="header" id="ban">
		<div class="container">
			<div class="w3ls_logo">
								<a href="/">Pakistan Address</a>
							</div>
			<div class="header_right">
			<nav class="navbar navbar-default">
				<!-- Brand and toggle get grouped for better mobile display -->
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
				</div>

				<!-- Collect the nav links, forms, and other content for toggling -->
				<div class="collapse navbar-collapse nav-wil" id="bs-example-navbar-collapse-1">
					<nav class="link-effect-7" id="link-effect-7">
						<ul class="nav navbar-nav">
														<li><a href="/">首页</a></li>
														<li><a href="/html/category/">文章分类</a></li>
														<li><a href="#">关于</a></li>
							<li><a href="#">联系</a></li>
						</ul>
					</nav>
				</div>
				<!-- /.navbar-collapse -->
			</nav>
			</div>
			<div class="clearfix"> </div>
		</div>
	</div>
<!-- //header -->
    <!-- about -->
    <div class="about">
        <div class="container">
            <h1 style="word-break: break-all;">Docker 安装 Confluence</h1>
            <ul>
                <li><a href="/">首页</a><i>|</i></li>
                <li><a href="/html/category/">文章分类</a><i>|</i></li>
                <li>正文</li>
            </ul>
        </div>
    </div>
    <!-- //about -->
    <!-- single -->
    <div class="single">
        <div class="container">
            <div class="col-md-9">
                <div class="wthree_single_grid1">
                      				  				  				<div id="content_views" class="markdown_views prism-atom-one-dark"> <h1>Docker 安装 Confluence</h1> <p>docker-compose.yaml 如下:</p> <pre><code class="prism language-docker">atlassian-confluence:     image: cptactionhank/atlassian-confluence:7.9.3     container_name: confluence     network_mode: host     volumes:       - "/etc/timezone:/etc/timezone:ro"       - "/etc/localtime:/etc/localtime:ro"       - "./atlassian-confluence/server.xml:/opt/atlassian/confluence/conf/server.xml"       - "./atlassian-confluence/lib/mysql-connector-java-8.0.22.jar:/opt/atlassian/confluence/confluence/WEB-INF/lib/mysql-connector-java-8.0.22.jar"       - "./atlassian-confluence/atlassian-agent.jar:/opt/atlassian/confluence/atlassian-agent.jar"     environment:       CATALINA_OPTS: "-javaagent:/opt/atlassian/confluence/atlassian-agent.jar"</code></pre> <p>atlassian-agent.jar 可以从如下地址获取:</p> <p>链接:https://pan.baidu.com/s/1JKgDtoTyXP8hHcooMiJgVQ 密码:0856</p> <p>server.xml 内容如下，仅修改了 Context 的path值为 ‘/confluence’</p> <pre><code class="prism language-sh">[root@alinyum-32 docker]# cat atlassian-confluence/server.xml  <?xml version="1.0"?> <Server port="8000" shutdown="SHUTDOWN">   <Service name="Tomcat-Standalone">     <Connector port="8090" connectionTimeout="20000" redirectPort="8443" maxThreads="48" minSpareThreads="10" enableLookups="false" acceptCount="10" URIEncoding="UTF-8" protocol="org.apache.coyote.http11.Http11NioProtocol"/>     <Engine name="Standalone" defaultHost="localhost">                                                                        <Host name="localhost" appBase="webapps" unpackWARs="true" autoDeploy="false" startStopThreads="4">                       <Context path="/confluence" docBase="../confluence" reloadable="false" useHttpOnly="true">                                           <!-- Logging configuration for Confluence is specified in confluence/WEB-INF/classes/log4j.properties -->               <Manager pathname=""/>                                                                                                  <Valve className="org.apache.catalina.valves.StuckThreadDetectionValve" threshold="60"/>                              </Context>                                                                                                              <Context path="${confluence.context.path}/synchrony-proxy" docBase="../synchrony-proxy" reloadable="false" useHttpOnly="true">           <Valve className="org.apache.catalina.valves.StuckThreadDetectionValve" threshold="60"/>                                             </Context>                                                                                                                           </Host>                                                                                                                              </Engine>                                                                                                                            </Service>                                                                                                                           </Server></code></pre> <h2>启动</h2> <p><code>docker-compose up -d confluence</code></p> <h2>nginx 配置:</h2> <pre><code>location /confluence {         proxy_pass http://127.0.0.1:8090;     }</code></pre> <p>使用浏览器访问 http://nginx_ip/confluence ,根据步骤配置,进入到需要输入许可证步骤时，使用如下方式破解。</p> <h2>破解</h2> <p>进入 docker 容器：<code>docker-compose exec confluence bash</code></p> <p>进入<code>atlassian-agent.jar</code> 目录:<code>cd /opt/atlassian/confluence/</code></p> <p>使用<code>java -jar atlassian-agent.jar</code> 查看信息如下:</p> <pre><code class="prism language-powershell">bash-4<span class="token punctuation">.</span>4$ java<span class="token operator">-</span>jar atlassian-agent<span class="token punctuation">.</span>jar   ==================================================== =======        Atlassian Crack Agent         ======= =======           https:<span class="token operator">/</span><span class="token operator">/</span>zhile<span class="token punctuation">.</span>io           ======= =======          QQ<span class="token function">Group</span>: 30347511          ======= ====================================================  KeyGen usage: java<span class="token operator">-</span>jar<span class="token operator">/</span>opt/atlassian/jira/atlassian-agent<span class="token punctuation">.</span>jar<span class="token punctuation">[</span><span class="token operator">-</span>d<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span>h<span class="token punctuation">]</span><span class="token operator">-</span>m        <span class="token punctuation">[</span><span class="token operator">-</span>n <arg><span class="token punctuation">]</span><span class="token operator">-</span>o <arg><span class="token operator">-</span>p <arg><span class="token operator">-</span>s <arg><span class="token operator">-</span>d<span class="token punctuation">,</span><span class="token operator">--</span>datacenter<span class="token keyword">Data</span> center license<span class="token namespace">[default: false]</span><span class="token operator">-</span>h<span class="token punctuation">,</span><span class="token operator">--</span>help                 Print help message<span class="token operator">-</span>m<span class="token punctuation">,</span><span class="token operator">--</span>mail <arg>           License email<span class="token operator">-</span>n<span class="token punctuation">,</span><span class="token operator">--</span>name <arg>           License name<span class="token namespace">[default: <license email>]</span><span class="token operator">-</span>o<span class="token punctuation">,</span><span class="token operator">--</span>organisation <arg>   License organisation<span class="token operator">-</span>p<span class="token punctuation">,</span><span class="token operator">--</span>product <arg>        License product<span class="token punctuation">,</span> support:<span class="token namespace">[crowd: Crowd]</span><span class="token namespace">[questions: Questions plugin for Confluence]</span><span class="token namespace">[crucible: Crucible]</span><span class="token namespace">[capture: Capture plugin for JIRA]</span><span class="token namespace">[conf: Confluence]</span><span class="token namespace">[training: Training plugin for JIRA]</span><span class="token punctuation">[</span><span class="token operator">*</span>: Third party plugin key<span class="token punctuation">,</span> looks like:                            com<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>bar<span class="token punctuation">]</span><span class="token namespace">[bitbucket: Bitbucket]</span><span class="token namespace">[tc: Team Calendars plugin for Confluence]</span><span class="token namespace">[bamboo: Bamboo]</span><span class="token namespace">[fisheye: FishEye]</span><span class="token namespace">[portfolio: Portfolio plugin for JIRA]</span><span class="token namespace">[jc: JIRA Core]</span><span class="token namespace">[jsd: JIRA Service Desk]</span><span class="token namespace">[jira: JIRA Software(common jira)]</span><span class="token operator">-</span>s<span class="token punctuation">,</span><span class="token operator">--</span>serverid <arg>       License server ID  ================================================================================<span class="token comment"># Crack agent usage: append -javaagent arg to system environment: JAVA_OPTS.</span><span class="token comment"># Example(execute this command or append it to setenv.sh/setenv.bat file):</span>    export JAVA_OPTS=<span class="token string">"-javaagent:/opt/atlassian/jira/atlassian-agent.jar ${JAVA_OPTS}"</span><span class="token comment"># Then start your confluence/jira server.</span></code></pre> <p>获取许可证：</p> <p>如下，参数说明:</p> <pre><code>-p: 要破解的产品名称，如上帮助信息中打印的 -p 参数说明 ，这里破解的为 jira -m: 邮箱号，随便写一个 -n: 名称，随便写 -o: 网站地址 -s: 服务器ID，在浏览器注册页面查看</code></pre> <p>破解命令：</p> <pre><code class="prism language-powershell">bash-4<span class="token punctuation">.</span>4$ java<span class="token operator">-</span>jar atlassian-agent<span class="token punctuation">.</span>jar<span class="token operator">-</span>p conf<span class="token operator">-</span>m aaa@xx<span class="token punctuation">.</span>com<span class="token operator">-</span>n kevin<span class="token operator">-</span>o https:<span class="token operator">/</span><span class="token operator">/</span>zhile<span class="token punctuation">.</span>io<span class="token operator">-</span>s BPST-Q7BN-WG5A-9BZ9  ==================================================== =======        Atlassian Crack Agent         ======= =======           https:<span class="token operator">/</span><span class="token operator">/</span>zhile<span class="token punctuation">.</span>io           ======= =======          QQ<span class="token function">Group</span>: 30347511          ======= ====================================================  Your license code<span class="token punctuation">(</span>Don't<span class="token function">copy</span> this line!<span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">)</span>:   AAABgA0ODAoPeJx9kl9vgjAUxd/5FCR7LoJ/5jBpMgWysAC6oTPZW8WrdsNCbgvTffqhYKLTmPSlT c+5v3vufZjDUn8thG529LY16NiDrqk78VRvm21TWyOA2GR5DmgEPAEhYbrPIWJboM44DL13xx8Gm oPAFM+EyxTQg5CYj8TsaHckLsgEeX5Q0ZlI+ZarCiStBfpir2+UyuWg1frd8BQMnmkh40KBYCIBb 5dz3DfVnmxi9qujfXFkJ0pvyWvrKPBDf+q5WlRsF4Dj1UwCSkqsE9wdrxyzZZEo43AhMlupH4ZgX Bnd+csSxUugCgu4yPL8ven5o3I7ELc1r2RpccyTrlgqQRvjmgku66erXJxMqMrPq/JJKWPsebczk mxbY92GPS9/hz5WDBVgQ9Hk5bs08N3Yi0hg9WzLsq3ek2l3Oxfx35p4DFgCVvLRJJ6St/4oIvOX3 pDYo0/71qJdj3BSYLJhEv6v2bkYqh3BHLls2qtA6Q3YJrQj4zeUXPwBk5YISDAsAhR1loAFS4Olz xWph1Pg27/qY+J6vgIUBlA/pjPdqYsR6wcVpnfVLOoEtaw=X02im  bash-4<span class="token punctuation">.</span>4$</code></pre> <p>以上命令执行完后，会输出破解后的 许可证，将其复制到浏览器许可证中即可破解，完成后按步骤安装完成即可。</p> <p>#在 Linux安装Confluence</p> <p>下载 Confluence<br /> 下载地址:<a href="http://www.m6000.cn/wp-content/themes/begin%20lts/inc/go.php?url=https://www.atlassian.com/software/confluence/download-archives"  rel="nofollow">https://www.atlassian.com/software/confluence/download-archives</p> <p>下载<code>tar.gz</code>文件 我这里下载的是<code>atlassian-confluence-7.4.9.tar</code> 版本</p> <p>解压文件到指定目录:</p> <pre><code class="prism language-sh">[root@alinyum-32 sortware]# tar -zxvf atlassian-confluence-7.4.9.tar -C /opt [root@alinyum-32 sortware]#  cd /opt [root@alinyum-32 sortware]# ln -s /opt/atlassian-confluence-7.4.9 /opt/atlassian-confluence</code></pre> <p>修改配置:</p> <pre><code class="prism language-sh">## 修改 Context 的path 值为 /confluence [root@alinyum-32 sortware]# vim /opt/atlassian-confluence/conf/server.xml  <?xml version="1.0"?> <Server port="8000" shutdown="SHUTDOWN">   <Service name="Tomcat-Standalone">     <Connector port="8090" connectionTimeout="20000" redirectPort="8443" maxThreads="48" minSpareThreads="10" enableLookups="false" acceptCount="10" URIEncoding="UTF-8" protocol="org.apache.coyote.http11.Http11NioProtocol"/>     <Engine name="Standalone" defaultHost="localhost">                                                                        <Host name="localhost" appBase="webapps" unpackWARs="true" autoDeploy="false" startStopThreads="4">                       <Context path="/confluence" docBase="../confluence" reloadable="false" useHttpOnly="true">                                           <!-- Logging configuration for Confluence is specified in confluence/WEB-INF/classes/log4j.properties -->               <Manager pathname=""/>                                                                                                  <Valve className="org.apache.catalina.valves.StuckThreadDetectionValve" threshold="60"/>                              </Context>                                                                                                              <Context path="${confluence.context.path}/synchrony-proxy" docBase="../synchrony-proxy" reloadable="false" useHttpOnly="true">           <Valve className="org.apache.catalina.valves.StuckThreadDetectionValve" threshold="60"/>                                             </Context>                                                                                                                           </Host>                                                                                                                              </Engine>                                                                                                                            </Service>                                                                                                                           </Server>  [root@alinyum-32 sortware]# vim /opt/atlassian-confluence/bin/setenv.sh  # 找到很多有 CATALINA_OPTS配置的位置，在最上面加上此行，atlassian-agent.jar文件可以通过上面 Docker方式安装的百度云盘获取。 CATALINA_OPTS="-javaagent:/opt/atlassian-confluence/atlassian-agent.jar" CATALINA_OPTS="-XX:+IgnoreUnrecognizedVMOptions ${CATALINA_OPTS}"  ## 设置 confluence home目录 ，并创建该目录 [root@alinyum-32 sortware]# vim /opt/atlassian-confluence/confluence/WEB-INF/classes/confluence-init.properties  confluence.home=/opt/atlassian-confluence/data [root@alinyum-32 sortware]# mkdir -p /opt/atlassian-confluence/data  ## 赋予目录所有者为指定用户 [root@alinyum-32 sortware]# chown -R kevin:kevin /opt/atlassian-confluence*</code></pre> <h2>加入systemctl系统服务 :</h2> <p>参考: https://confluence.atlassian.com/confkb/run-confluence-as-a-systemd-service-on-linux-937177781.html</p> <pre><code class="prism language-sh">[root@alinyum-32 sortware]# cat /lib/systemd/system/confluence.service  [Unit] Description=Atlassian Confluence Server Documentation=https://confluence.atlassian.com/doc/installing-confluence-on-linux-from-archive-file-255362363.html After=network.targe [Service] Type=forking PIDFile=/opt/atlassian-confluence/work/catalina.pid ExecStart=/opt/atlassian-confluence/bin/start-confluence.sh User=kevin ExecStop=/opt/atlassian-confluence/bin/stop-confluence.sh TimeoutSec=200 LimitNOFILE=4096 LimitNPROC=4096 [Install] WantedBy=multi-user.target [root@alinyum-32 sortware]#</code></pre> <h1>加入数据库驱动包</h1> <p>根据你要使用的数据库，将对应的驱动包加入到<code>/opt/atlassian-confluence/confluence/WEB-INF/lib</code>目录中。</p> <h2>启动服务</h2> <pre><code class="prism language-sh">[root@alinyum-32 sortware]# systemctl daemon-reload [root@alinyum-32 sortware]# systemctl enable confluence.service [root@alinyum-32 sortware]# systemctl start confluence.service [root@alinyum-32 sortware]# systemctl status confluence.service</code></pre> <h2>破解</h2> <p>破解方式按上面 Docker安装方式破解即可。</p> </div> 			                </div>
                <div class="col-md-12 mt-5">
                                        <p>上一个：<a href="/html/category/article-2273.htm">springboot处理时间date，在前后端传输遇到问题，时间插入数据库会提前一天？</a></p>
                                        <p>下一个：<a href="/html/category/article-2275.htm">Spring Boot Admin 的使用</a></p>
                                    </div>
                            </div>
            <div class="col-md-3">
                <div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">热门文章</h3>
    </div>
    <div class="panel-body">
        <ul class="p-0 x-0" style="list-style: none;margin: 0;padding: 0;">
                        <li class="py-2"><a href="/html/category/article-5585.htm" title="宠物粮加工厂投资成本高吗知乎（宠物粮食加工厂挣钱吗）">宠物粮加工厂投资成本高吗知乎（宠物粮食加工厂挣钱吗）</a></li>
                        <li class="py-2"><a href="/html/category/article-2525.htm" title="自研FeignClient轻量级http客户端">自研FeignClient轻量级http客户端</a></li>
                        <li class="py-2"><a href="/html/category/article-2512.htm" title="测试开发该如何在团队中推广新工具和新技术">测试开发该如何在团队中推广新工具和新技术</a></li>
                        <li class="py-2"><a href="/html/category/article-4531.htm" title="福建农大动物医院没开了吗最近（福州农大动物医院怎么样）">福建农大动物医院没开了吗最近（福州农大动物医院怎么样）</a></li>
                        <li class="py-2"><a href="/html/category/article-2511.htm" title="vue3.0 elementUI实现上传文件的暂停继续功能">vue3.0 elementUI实现上传文件的暂停继续功能</a></li>
                        <li class="py-2"><a href="/html/category/article-4112.htm" title="Vue3实践setup函数详解">Vue3实践setup函数详解</a></li>
                        <li class="py-2"><a href="/html/category/article-2545.htm" title="Metalama简介2.利用Aspect在编译时进行消除重复代码">Metalama简介2.利用Aspect在编译时进行消除重复代码</a></li>
                        <li class="py-2"><a href="/html/category/article-2510.htm" title="记一次jenkins发送邮件报错 一直报错 Could not send email as a part of the post-build publishers问题">记一次jenkins发送邮件报错 一直报错 Could not send email as a part of the post-build publishers问题</a></li>
                        <li class="py-2"><a href="/html/category/article-3440.htm" title="IDEA工程-数据库连接-mysql连接">IDEA工程-数据库连接-mysql连接</a></li>
                        <li class="py-2"><a href="/html/category/article-3771.htm" title="使用Echarts3实现动态折线图">使用Echarts3实现动态折线图</a></li>
                    </ul>
    </div>
</div>

<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">归纳</h3>
    </div>
    <div class="panel-body">
        <ul class="p-0 x-0" style="list-style: none;margin: 0;padding: 0;">
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">26</span> <a href="/html/date/2024-07/" title="2024-07 归档">2024-07</a></h4>
            </li>
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">60</span> <a href="/html/date/2024-06/" title="2024-06 归档">2024-06</a></h4>
            </li>
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">62</span> <a href="/html/date/2024-05/" title="2024-05 归档">2024-05</a></h4>
            </li>
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">60</span> <a href="/html/date/2024-04/" title="2024-04 归档">2024-04</a></h4>
            </li>
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">62</span> <a href="/html/date/2024-03/" title="2024-03 归档">2024-03</a></h4>
            </li>
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">44</span> <a href="/html/date/2024-02/" title="2024-02 归档">2024-02</a></h4>
            </li>
                    </ul>
    </div>
</div>

            </div>
        </div>
    </div>
    <!-- //single -->
    <!-- footer -->
	
	<div class="copy-right-social">
		<div class="container">
			<div class="footer-pos">
				<a href="#ban" class="scroll"><img src="/assets/addons/xcblog/img/pakistanaddress/arrow.png" alt=" " class="img-responsive" /></a>
			</div>
            <div class="col-lg-8 footer-left">
                <p class="m-0">Pakistan Address 版权所有</p>
            </div>
			<div class="copy-right-social1">
				<div class="w3l_social_icons w3l_social_icons1">
					<ul>
						<li><a href="#" class="facebook"></a></li>
						<li><a href="#" class="twitter"></a></li>
						<li><a href="#" class="google_plus"></a></li>
						<li><a href="#" class="pinterest"></a></li>
						<li><a href="#" class="instagram"></a></li>
					</ul>
				</div>
			</div>
			<div class="clearfix"> </div>
		</div>
	</div>
<!-- //footer -->
<!-- for bootstrap working -->
	<script src="/assets/addons/xcblog/js/frontend/pakistanaddress/bootstrap.js"></script>
    <script>
    $(function() {
        $('.js_to').click(function() {
            var url = $(this).data('url');
            var code = $(this).data('code');
            url += code;

            window.open(url);
        })
    });
    </script>
</body>

</html>